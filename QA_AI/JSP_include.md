# JSP include文の違い

- [JSP include文の違い](#jsp-include文の違い)
  - [質問](#質問)
  - [回答](#回答)
  - [🧩 1. 静的インクルード（`<%@ include file="..." %>`）](#-1-静的インクルード-include-file-)
    - [📖 構文](#-構文)
    - [🔍 特徴](#-特徴)
    - [⚙️ 動作のイメージ](#️-動作のイメージ)
    - [✅ メリット](#-メリット)
    - [⚠️ デメリット](#️-デメリット)
  - [⚡ 2. 動的インクルード（`<jsp:include page="..." />`）](#-2-動的インクルードjspinclude-page-)
    - [📖 構文](#-構文-1)
    - [🔍 特徴](#-特徴-1)
    - [⚙️ 動作のイメージ](#️-動作のイメージ-1)
    - [✅ メリット](#-メリット-1)
    - [⚠️ デメリット](#️-デメリット-1)
  - [🧭 まとめ比較表](#-まとめ比較表)
  - [💡 実用例](#-実用例)
    - [静的 include の例（レイアウト固定）](#静的-include-の例レイアウト固定)
    - [動的 include の例（可変コンテンツ）](#動的-include-の例可変コンテンツ)

## 質問

``` txt
JSPのinclude文2種類
```

---

## 回答

JSP（JavaServer Pages）で使われる `<%@ include %>` と `<jsp:include>` の2種類の「include文」は、どちらも他のファイルを取り込むために使いますが、**タイミングと動作が大きく異なります。**

---

## 🧩 1. 静的インクルード（`<%@ include file="..." %>`）

### 📖 構文

```jsp
<%@ include file="header.jsp" %>
```

### 🔍 特徴

* **翻訳時（コンパイル前）** にファイル内容をそのまま埋め込む。
* JSPファイルが **サーブレットに変換される段階** で結合される。
* つまり、**1つの大きなJSPファイルとしてコンパイル** される。
* 変数やスコープを共有できる（同じJSP内扱い）。

### ⚙️ 動作のイメージ

```
index.jsp
 ├── <%@ include file="header.jsp" %>
 ├── <body> ... </body>
```

→ コンパイル時に `header.jsp` の内容が展開され、1つのJavaソースになる。

### ✅ メリット

* 実行時オーバーヘッドがない（コンパイル時にまとめられる）。
* 共通レイアウトなど、頻繁に変わらない静的部分に最適。

### ⚠️ デメリット

* include先のファイルを変更した場合、再コンパイルが必要。
* 実行中に内容を差し替えたい用途には不向き。

---

## ⚡ 2. 動的インクルード（`<jsp:include page="..." />`）

### 📖 構文

```jsp
<jsp:include page="header.jsp" flush="true" />
```

### 🔍 特徴

* **実行時（リクエスト時）** に指定ファイルを呼び出す。
* 実行時にJSPコンテナが別のサーブレットを呼び出し、その出力結果を取り込む。
* それぞれ独立したスコープ（`request` や `pageContext`）で実行される。

### ⚙️ 動作のイメージ

```
index.jsp
 ├── <jsp:include page="header.jsp" />
 ├── <body> ... </body>
```

→ 実行時に `header.jsp` が呼ばれ、生成されたHTMLを `index.jsp` に挿入。

### ✅ メリット

* include先を動的に変更できる（変数で指定可能）。

  ```jsp
  <jsp:include page="<%= somePage %>" />
  ```
* 更新が即反映される（サーバ再起動不要）。
* 独立した実行環境で安全。

### ⚠️ デメリット

* 実行時にオーバーヘッドがある（サブリクエストが発生）。
* 変数スコープが独立しているため、直接の変数共有はできない。

---

## 🧭 まとめ比較表

| 特徴       | `<%@ include %>`（静的） | `<jsp:include>`（動的） |
| -------- | -------------------- | ------------------- |
| 実行タイミング  | 翻訳（コンパイル）時           | 実行（リクエスト）時          |
| 内容の取り込み  | ソースコードを埋め込み          | 出力結果を取り込み           |
| スコープ共有   | 同一スコープ（共有可）          | 独立スコープ（共有不可）        |
| パフォーマンス  | 高速（1ファイル化）           | やや遅い（実行時呼出）         |
| ファイル更新反映 | 再コンパイル必要             | 即時反映される             |
| 主な用途     | 静的レイアウト              | 動的コンテンツ／モジュール呼出     |

---

## 💡 実用例

### 静的 include の例（レイアウト固定）

```jsp
<%@ include file="/common/header.jsp" %>
<body>
  <h1>Welcome</h1>
</body>
<%@ include file="/common/footer.jsp" %>
```

### 動的 include の例（可変コンテンツ）

```jsp
<jsp:include page="/contents/${pageId}.jsp" />
```

---

希望があれば、この2つを**実際にコンパイル後のサーブレットソースコードで比較**してみせることもできます。やってみますか？
