# Excel

- [Excel](#excel)
  - [列の値を参照して行に色を塗る](#列の値を参照して行に色を塗る)
    - [列の値を参照して行に色を塗る:参考](#列の値を参照して行に色を塗る参考)
  - [直交表プルダウン](#直交表プルダウン)
    - [仕込み](#仕込み)
    - [設定](#設定)
    - [直交表プルダウン:参考](#直交表プルダウン参考)
  - [シートコピー時になんか出る](#シートコピー時になんか出る)
  - [表のコピペ](#表のコピペ)
  - [参照先の指定に数式を使う(OFFSET関数)](#参照先の指定に数式を使うoffset関数)
  - [秒 -\> 時分秒変換](#秒---時分秒変換)
    - [時](#時)
    - [分](#分)
    - [秒](#秒)
    - [結合](#結合)
  - [CSVを読み込む](#csvを読み込む)
  - [条件付き書式](#条件付き書式)
    - [同じ値の2件目以降を取得する](#同じ値の2件目以降を取得する)
  - [検索して一致したら加算する](#検索して一致したら加算する)
  - [名前削除](#名前削除)
  - [オブジェクトの範囲選択](#オブジェクトの範囲選択)
  - [1セルに書き込める文字数](#1セルに書き込める文字数)
  - [Format](#format)

## 列の値を参照して行に色を塗る

1. 対象範囲の左上にセルカーソルを合わせる
2. 条件付き書式 - 新しいルールをクリック
3. 数式を使用して、書式設定するセルを決定をクリック
4. 条件と、設定する書式記載する。
   ```=${対象列}{対象行の１行目}="判定条件"```
5. セルカーソルの右下を適用範囲にドラッグ・アンド・ドロップ
6. オートフィルオプションをクリック
7. 書式のみコピーを選択

### 列の値を参照して行に色を塗る:参考

- [条件付き書式を使って特定の文字が入っている行に色を付ける:クリエアナブキのちょこテク](https://www.crie.co.jp/chokotech/detail/270/)

## 直交表プルダウン

### 仕込み

1. 表を作成する
2. 表のタイトル行を選択
3. 左上のセル名が出力されている箇所に任意のリスト名を入力
4. 表の各列を選択
5. 左上のセル名が出力されている箇所に各列の1行目を入力

### 設定

1. 左側（タイトル列）設定
   1. プルダウンを設定したい列を設定
   2. データ -> データの入力規則 -> データの入力規則
   3. 設定タブ -> 入力値の種類 -> リスト -> 仕込みの3で設定した値 -> OK
2. 右側（値列）設定
   1. プルダウンを設定したい列を設定
   2. データ -> データの入力規則 -> データの入力規則
   3. 設定タブ -> 入力値の種類 -> リスト -> INDIRECT(左列の一番上のセルのアドレス(絶対アドレスは不要)) -> OK

### 直交表プルダウン:参考

- [前の選択で次の選択肢が変わる連動ドロップダウンリスト:Be COOL Users](https://www.becoolusers.com/excel/indirect-list.html)

## シートコピー時になんか出る

1. Ctrl + F3押下
2. 全消し

## 表のコピペ

セル結合や書式を含めたコピーを行う。

1. コピー対象の範囲をコピー
2. コピー先を選択
3. ctrl + alt + v
4. 「リンク貼り付け」をクリック
5. ctrl + alt + v
6. 「書式」を選択
7. 「OK」をクリック

## 参照先の指定に数式を使う(OFFSET関数)

- OFFSET(引数1, 引数2, 引数3)
  - 引数1：基準のセル
  - 引数2：基準のセルから何行移動するか
  - 引数3：基準のセルから何列移動するか

## 秒 -> 時分秒変換

時・分・秒で別のセルに分けてから結合したほうが楽。

- A2 : 元の秒数
- B2 : 時
- C2 : 分
- D2 : 秒

### 時

``` txt
=FLOOR.MATH(INT(A2)/(60*60))
```

### 分

``` txt
=FLOOR.MATH(INT((A2-(B2*60*60))/60))
```

### 秒

``` txt
=A2-((B2*60*60)+(C2*60))
```

### 結合

``` txt
=TEXT(B2,"00") & ":" & TEXT(C2,"00") & ":" & TEXT(D2,"00.000")
```

## CSVを読み込む

1. テキストベースでコピペ
2. データタブ -> 区切り位置をクリック

## 条件付き書式

### 同じ値の2件目以降を取得する

``` txt
=countif($「先頭セル（固定）」:1件目のセル , 先頭セル) > 1
```

## 検索して一致したら加算する

``` txt
=SUMIF(「列名」:「列名」, キーの値, 「加算する値の列」:「加算する値の列」)
```

## 名前削除

ブック単位の整理。  
数式タブ -> 名前の整理から削除。

## オブジェクトの範囲選択

ホームタブ -> 検索と選択 -> オブジェクトの選択

## 1セルに書き込める文字数

- 32767文字
    - セル結合しても変わらない。

## Format

- [BurnDownChart.xlsx](./BurnDownChart.xlsx)